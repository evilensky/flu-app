<%= form_for @survey, url: survey_submissions_path, method: :post, html: { class: 'form-horizontal label-left' } do |f| %>
  <%= hidden_field_tag 'survey[survey_id]', @survey.id %>
  <%= hidden_field_tag 'survey[user_id]', @user.id %>
  <%= hidden_field_tag 'survey[token]', @survey_token %>
  <fieldset>
    <% @survey.questions.order(:data_label).each do |q| %>
      <%= f.fields_for :questions, q do |q_fields| %>
        <% case q.input_type %>
        <% when 'string' %>
          <div class="control-group">
            <label class="control-label"><%= q.content %></label>
            <div class="controls form-group">
              <%= text_field_tag "survey[response_data][#{ q.data_label }]", nil, class: 'col-sm-6 col-xs-12' %>
            </div>
          </div>
        <% when 'date' %>
          <div class="control-group">
            <label class="control-label"><%= q.content %></label>
            <div class="controls form-group">
              <%= text_field_tag "survey[response_data][#{ q.data_label }]", nil, class: 'col-sm-6 col-xs-12 datepicker' %>
            </div>
          </div>
        <% when 'integer' %>
          <div class="control-group">
            <label class="control-label"><%= q.content %></label>
            <div class="controls form-group">
              <%= number_field_tag "survey[response_data][#{ q.data_label }]", nil, class: 'col-sm-6 col-xs-12' %>
            </div>
          </div>
        <% when 'check_boxes' %>
          <div class="control-group">
            <label class="control-label"><%= q.content %></label>
            <div class="controls form-group">
              <div class="btn-group btn-group-vertical col-sm-12" data-toggle="buttons-checkbox">
              <% q.responses.each do |response| %>
                <label class="btn btn-transparent" data-toggle-class="btn-default" data-toggle-passive-class="btn-inverse">
                  <%= check_box_tag "survey[response_data][#{ q.data_label }][]", response.id %>
                  <%= response.label %>
                </label>
              <% end %>
              </div>
            </div>
          </div>
        <% when 'radio_buttons' %>
          <div class="control-group">
            <label class="control-label"><%= q.content %></label>
            <div class="controls form-group">
              <div class="btn-group btn-group-vertical col-sm-12" data-toggle="buttons-radio">
              <% q.responses.each do |response| %>
                <label class="btn btn-transparent" data-toggle-class="btn-default" data-toggle-passive-class="btn-inverse">
                  <%= radio_button_tag "survey[response_data][#{ q.data_label }]", response.id %>
                  <%= response.label %>
                </label>
              <% end %>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </fieldset>

  <%= f.submit 'Submit', { class: 'btn btn-primary btn-large' } %>
<% end %>
